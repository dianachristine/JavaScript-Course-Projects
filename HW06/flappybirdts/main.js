(()=>{"use strict";function t(t){t.style.backgroundColor="#e86101",t.style.border="1px solid #f0eaa1",t.style.cursor="pointer",t.style.boxShadow="0px 0px 20px 1px #f0eaa1 inset",t.style.margin="0px 0px 0px 5px",t.style.borderRadius="7px",t.style.padding="2px"}var e=function(){this.name="",this.score=0};const o=function(){function t(t,e,o){void 0===t&&(t=30),void 0===e&&(e=21),void 0===o&&(o=7),this.PATH_WIDTH=15,this.scoreBoard=[],this.board=[],this.rowCount=t,this.colCount=e,this.defaultPathPostision=o,this.addSomeDefaultGamescores(),this.intializeBoard()}return t.prototype.addSomeDefaultGamescores=function(){this.addDefaultScoreToGameScores("Carlos",36),this.addDefaultScoreToGameScores("Rafael",178),this.addDefaultScoreToGameScores("Luna",1),this.addDefaultScoreToGameScores("Isabella Sofia",155)},t.prototype.addDefaultScoreToGameScores=function(t,o){var i=new e;i.name=t,i.score=o,this.scoreBoard.push(i)},t.prototype.isBirdAlive=function(t){return t.isTunnel},t.prototype.startGame=function(){this.gameScore=new e,this.gameStartDate=Date.now()},t.prototype.stopGame=function(){this.gameScore.score=Math.floor((Date.now()-this.gameStartDate)/1e3),this.gameStartDate=void 0},t.prototype.createGameColumn=function(t,e){for(var o=[],i=0;i<this.rowCount;i++)switch(!0){case i<t:o.push(-1);break;case i>=t+e:o.push(1);break;default:o.push(0)}return o},t.prototype.intializeBoard=function(){for(var t=0;t<this.colCount;t++)this.board.push(this.createGameColumn(this.defaultPathPostision,this.PATH_WIDTH))},t.prototype.getGameBoard=function(){return this.board},t.prototype.getDefaultPathPosition=function(){return this.defaultPathPostision},t.prototype.getPathWidth=function(){return this.PATH_WIDTH},t.prototype.gameCellPath=function(){return 0},t.prototype.gameCellUp=function(){return-1},t.prototype.gameCellDown=function(){return 1},t.prototype.getGameScore=function(){return this.gameScore.score},t.prototype.submitScore=function(t){this.gameScore.name=t,this.scoreBoard.push(this.gameScore),this.cleanScore()},t.prototype.cleanScore=function(){this.gameScore=void 0},t.prototype.generateNewColumnData=function(t,e){if(void 0===e&&(e=7),t){e=Number(t.dataset.pathPosition);var o=Math.random()<.5,i=Math.random()*(this.PATH_WIDTH-2)-5;e+(i=Math.ceil(2*Math.random()-1.5)*i)>0&&e+i<this.PATH_WIDTH-7&&(o?e+=i:e-=i)}return this.createGameColumn(e,this.PATH_WIDTH)},t}(),i=function(){function t(t,e,o){this.isRunning=!1,this.model=t,this.viewContainer=e,this.gameHeight=window.innerHeight-o,this.rowHeight=Math.floor(this.gameHeight/this.model.rowCount),this.colWidth=Math.floor(window.innerWidth/this.model.colCount)}return t.prototype.run=function(){this.isRunning=!0,this.viewContainer.innerHTML="",this.viewContainer.append(this.getBoardHtml(this.model)),this.birdCol=Math.floor(this.model.colCount/2),this.birdRow=this.model.defaultPathPostision+Math.floor(this.model.PATH_WIDTH/2),document.addEventListener("keyup",this.handleKey.bind(this)),this.model.startGame(),this.animate(this.viewContainer.lastElementChild,this.model)},t.prototype.stop=function(){this.isRunning=!1},t.prototype.resizeUi=function(){this.isRunning&&(this.viewContainer.innerHTML="",this.gameHeight=window.innerHeight-this.viewContainer.offsetTop,this.rowHeight=Math.floor(this.gameHeight/this.model.rowCount),this.colWidth=Math.floor(window.innerWidth/this.model.colCount),this.viewContainer.append(this.getBoardHtml(this.model)))},t.prototype.getBoardHtml=function(t){var e=this,o=document.createElement("div");return o.id="gameboard",o.style.maxHeight=this.gameHeight+"px",t.getGameBoard().forEach((function(i){var n=e.generateNewColumn(i,t);n.dataset.pathPosition=e.model.getDefaultPathPosition().toString(),o.append(n)})),o},t.prototype.generateNewColumn=function(t,e){var o=this,i=document.createElement("div");return i.style.display="inline-block",i.style.minWidth=this.colWidth+"px",i.style.maxWidth=this.colWidth+"px",i.dataset.pathPosition=this.model.getDefaultPathPosition().toString(),t.forEach((function(t){var n=document.createElement("div");t===e.gameCellUp()?n.style.backgroundColor="#73bf2e":t===e.gameCellDown()?n.style.backgroundColor="#558022":(n.style.backgroundColor="#70c5ce",n.dataset.isTunnel="true"),n.style.minHeight=o.rowHeight+"px",n.style.maxHeight=o.rowHeight+"px",i.append(n)})),i},t.prototype.animate=function(t,e,o){var i=this;void 0===o&&(o=!0),setTimeout((function(){i.bird=t.childNodes[i.birdCol].childNodes[i.birdRow],i.bird.style.backgroundImage="none",(o=i.model.isBirdAlive(i.bird.dataset))||(i.birdCol--,i.model.stopGame());var n=t.firstElementChild;if(n){var r=i.generateNewColumn(i.model.generateNewColumnData(t.lastElementChild),e);if(n.remove(),t.append(r),i.bird=t.childNodes[i.birdCol].childNodes[i.birdRow],i.styleBirdElem(o),o)i.animate(t,e);else{var a=prompt("         GAME OVER!\n         Your score: "+i.model.getGameScore()+"s\nPlease enter your name: ","guest");i.model.submitScore(null!=a?a:"anonymous")}}}),50)},t.prototype.styleBirdElem=function(t){this.bird.style.backgroundImage=t?"url('https://res.cloudinary.com/practicaldev/image/fetch/s--iMqLw9ix--/c_imagga_scale,f_auto,fl_progressive,h_420,q_66,w_1000/https://dev-to-uploads.s3.amazonaws.com/i/d4sfv1jes6dt4s4083vq.gif')":"url('https://media0.giphy.com/media/W1eYa3FHESfTL33LJ3/giphy.gif')",this.bird.style.backgroundRepeat="no-repeat",this.bird.style.backgroundSize="contain",this.bird.style.backgroundPosition="center"},t.prototype.handleKey=function(t){if("keyup"===t.type){switch(t.key){case"ArrowDown":this.birdRow++;break;case"ArrowUp":this.birdRow--}this.bird.style.backgroundImage="none"}},t}(),n=function(){function t(t,e){this.isRunning=!1,this.viewContainer=e,this.model=t}return t.prototype.run=function(){this.isRunning=!0,this.viewContainer.innerHTML="LEADERBOARD",this.viewContainer.style.fontFamily="Courier New, monospace",this.viewContainer.style.fontSize="200%",this.model.scoreBoard.sort((function(t,e){return t.score>e.score?-1:1}));var t=this.buildTable(["Name","Score"],this.model.scoreBoard);t.style.border="1px solid black",t.style.backgroundColor="#f3c489",t.style.marginLeft="auto",t.style.marginRight="auto",this.viewContainer.appendChild(t),this.viewContainer.style.textAlign="center",this.viewContainer.style.padding="20m",document.body.style.backgroundColor="#f0eaa1"},t.prototype.stop=function(){this.isRunning=!1},t.prototype.buildTable=function(t,e){for(var o=document.createElement("table"),i=document.createElement("thead"),n=document.createElement("tbody"),r=document.createElement("tr"),a=0;a<t.length;a++){var s=document.createElement("th");s.innerHTML=t[a],r.appendChild(s)}i.appendChild(r),o.appendChild(i);for(var d=0;d<e.length;d++){var l=document.createElement("tr"),h=document.createElement("td");h.innerHTML=e[d].name,l.appendChild(h);var c=document.createElement("td");c.innerHTML=e[d].score.toString(),l.appendChild(c),n.appendChild(l)}return o.appendChild(n),o},t}();var r,a=new o,s=((r=document.createElement("div")).id="view-container",r.innerText="CONTAINER",r),d=new i(a,s,22),l=new n(a,s),h=function(){var t=document.createElement("div");return t.id="main",t}();document.body.append(h);var c=function(e,o){var i=document.createElement("div");i.id="control",i.style.maxHeight="22px",i.style.minHeight="22px";var n=document.createElement("button");n.id="statistics",n.innerText="Statistics";var r=document.createElement("button");return r.id="game",r.innerText="Play game",i.append(n),i.append(r),n.addEventListener("click",e),r.addEventListener("click",e),t(n),t(r),i}((function(t){switch(t.target.id){case"game":l.stop(),d.run();break;case"statistics":d.stop(),l.run()}}));h.append(c),h.append(s),l.run(),window.addEventListener("resize",(function(){d.resizeUi()}))})();